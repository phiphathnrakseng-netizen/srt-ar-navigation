<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <title>ระบบนำทาง AR | วิทยาลัยเทคนิคสุราษฎร์ธานี</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            /* STC Palette - อ้างอิงจากตราวิทยาลัย */
            --stc-navy: #002D62;      /* น้ำเงินหลัก */
            --stc-maroon: #800000;    /* แดงเลือดหมู */
            --stc-red: #C41E3A;       /* แดงสว่างสำหรับเน้น */
            --stc-gray: #F4F7FA;      /* พื้นหลัง */
            --stc-white: #FFFFFF;
        }

        body { 
            font-family: 'Noto Sans Thai', sans-serif; 
            background-color: var(--stc-gray); 
            color: #1A1A1A;
            margin: 0;
            -webkit-font-smoothing: antialiased;
        }

        /* --- Loading Screen (Formal) --- */
        #loading-screen {
            position: fixed; inset: 0;
            background: var(--stc-white);
            z-index: 9999;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
        }

        .loader-logo {
            width: 140px;
            margin-bottom: 2rem;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));
        }

        /* --- Navigation --- */
        .top-nav {
            background: var(--stc-white);
            border-bottom: 4px solid var(--stc-maroon);
            height: 80px;
        }

        .nav-link {
            font-weight: 700; 
            color: var(--stc-navy);
            transition: 0.2s;
            padding: 0 1rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nav-link-active {
            color: var(--stc-maroon);
            background: rgba(128, 0, 0, 0.05);
            height: 100%;
            display: flex;
            align-items: center;
        }

        /* --- Header Section --- */
        .official-header {
            background: var(--stc-navy);
            color: white;
            padding: 5rem 2rem;
            position: relative;
            border-bottom: 8px solid var(--stc-red);
            /* ลายกราฟิกแบบแผนที่นำทาง */
            background-image: radial-gradient(circle at 20% 50%, rgba(255,255,255,0.05) 0%, transparent 25%),
                              linear-gradient(135deg, var(--stc-navy) 0%, #001530 100%);
        }

        /* --- Card UI (Modern Square) --- */
        .room-card {
            background: white;
            border-left: 5px solid var(--stc-maroon);
            border-radius: 2px;
            box-shadow: 0 2px 0 rgba(0,0,0,0.05);
            transition: all 0.3s cubic-bezier(0.165, 0.84, 0.44, 1);
            position: relative;
            overflow: hidden;
        }

        .room-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 30px rgba(0,45,98,0.1);
            border-left-color: var(--stc-navy);
        }

        .btn-stc-action {
            background: var(--stc-maroon);
            color: white;
            border-radius: 2px;
            font-weight: 700;
            transition: 0.3s;
            display: flex; align-items: center; justify-content: center; gap: 10px;
        }

        .btn-stc-action:hover {
            background: var(--stc-navy);
            transform: scale(1.02);
        }

        /* --- Search Bar --- */
        .search-box {
            background: white;
            border: 2px solid #E2E8F0;
            border-radius: 4px;
            transition: 0.3s;
        }

        .search-box:focus-within {
            border-color: var(--stc-navy);
            box-shadow: 0 0 0 4px rgba(0, 45, 98, 0.1);
        }

        /* --- Modal --- */
        .modal-content {
            border-radius: 4px;
            border-top: 10px solid var(--stc-maroon);
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- Footer Styles --- */
        .main-footer {
            background: white;
            border-top: 1px solid #E2E8F0;
            padding: 2rem 0;
            margin-top: 4rem;
        }
    </style>
</head>
<body>

    <div id="loading-screen">
        <img src="https://scontent.furt2-1.fna.fbcdn.net/v/t39.30808-6/223303958_665537047696775_5725965526684764441_n.jpg?_nc_cat=108&ccb=1-7&_nc_sid=a5f93a&_nc_eui2=AeHYdDp67RfF6Yo008Da8znibSDAaVG9sWptIMBpUb2xaskuSs8Dg-GqxsRQzyU0pPy_Mf3g1YP_1vszniK1R7r4&_nc_ohc=iLPCoGJ_o9MQ7kNvwHGpOes&_nc_oc=Admc76_VFpmfz4NLFaNjJqUwuNqOFeHLFGbaDxOaPCDS26LE8Iplmx8f5_Ma6B3ikqc&_nc_zt=23&_nc_ht=scontent.furt2-1.fna&_nc_gid=FC6zBJ6W_D2X94i0VBQJwg&oh=00_AfsonydYo7dgiP0FZA4xHtgd_gWZS0fY2QnA_BiHk665SQ&oe=69926B7A" 
             alt="STC Logo" class="loader-logo">
        <h2 class="text-[#002D62] font-extrabold text-2xl tracking-tighter">SURAT THANI TECHNICAL COLLEGE</h2>
        <p class="text-maroon font-bold text-sm mb-6">DEPARTMENT OF INFORMATION TECHNOLOGY</p>
        <div class="w-64 h-1 bg-gray-100 relative overflow-hidden">
            <div id="progress-fill" class="absolute inset-y-0 left-0 bg-maroon-700 w-0 transition-all duration-300" style="background: var(--stc-maroon);"></div>
        </div>
    </div>

    <nav class="top-nav sticky top-0 z-50 flex justify-between items-center px-8 shadow-lg">
        <div class="flex items-center gap-4">
            <img src="https://scontent.furt2-1.fna.fbcdn.net/v/t39.30808-6/223303958_665537047696775_5725965526684764441_n.jpg?_nc_cat=108&ccb=1-7&_nc_sid=a5f93a&_nc_eui2=AeHYdDp67RfF6Yo008Da8znibSDAaVG9sWptIMBpUb2xaskuSs8Dg-GqxsRQzyU0pPy_Mf3g1YP_1vszniK1R7r4&_nc_ohc=iLPCoGJ_o9MQ7kNvwHGpOes&_nc_oc=Admc76_VFpmfz4NLFaNjJqUwuNqOFeHLFGbaDxOaPCDS26LE8Iplmx8f5_Ma6B3ikqc&_nc_zt=23&_nc_ht=scontent.furt2-1.fna&_nc_gid=FC6zBJ6W_D2X94i0VBQJwg&oh=00_AfsonydYo7dgiP0FZA4xHtgd_gWZS0fY2QnA_BiHk665SQ&oe=69926B7A" 
                 class="h-14 w-14 object-contain" alt="STC">
            <div class="hidden md:block">
                <div class="font-black text-lg text-[#002D62] leading-none">วิทยาลัยเทคนิคสุราษฎร์ธานี</div>
                <div class="text-[11px] font-bold text-red-700 mt-1 uppercase tracking-widest border-t border-red-100 pt-1">IT Augmented Reality Navigation</div>
            </div>
        </div>
        <div class="flex h-full items-center">
            <a href="index.html" class="nav-link text-sm" id="nav-home">หน้าแรก</a>
            <a href="?floor=3" class="nav-link text-sm" id="nav-f3">ชั้น 3</a>
            <a href="?floor=4" class="nav-link text-sm" id="nav-f4">ชั้น 4</a>
        </div>
    </nav>

    <header class="official-header">
        <div class="max-w-6xl mx-auto">
            <div class="flex items-center gap-3 mb-6">
                <span class="bg-red-600 text-white text-[10px] font-bold px-3 py-1 tracking-widest uppercase">System v2.0</span>
                <div class="h-[1px] w-20 bg-white/30"></div>
            </div>
            <h1 class="text-4xl md:text-6xl font-black mb-6 leading-tight">
                Indoor AR <span class="text-red-500">Navigation</span><br>
                <span class="text-white/80 font-medium text-2xl md:text-3xl">แผนกวิชาเทคโนโลยีสารสนเทศ</span>
            </h1>
            <p id="header-desc" class="text-gray-300 max-w-2xl text-lg leading-relaxed font-light">
                นวัตกรรมการนำทางภายในอาคารด้วยเทคโนโลยีความจริงเสริม (AR) มุ่งหน้าสู่ห้องเรียนและห้องปฏิบัติการอย่างแม่นยำ
            </p>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-6 py-12">
        <div id="search-container" class="mb-12 hidden">
            <div class="search-box p-1 flex items-center bg-white">
                <div class="px-6 text-navy-900"><i class="fa-solid fa-search text-xl text-[#002D62]"></i></div>
                <input type="text" id="searchInput" onkeyup="searchRoom()" placeholder="ระบุชื่อห้องที่ต้องการค้นหา..." class="w-full py-5 outline-none font-bold text-xl text-navy-900 bg-transparent">
                <div class="px-6 border-l flex flex-col items-center">
                    <span class="text-[10px] font-bold text-gray-400 uppercase">Current Floor</span>
                    <span class="text-2xl font-black text-maroon" id="floor-title">--</span>
                </div>
            </div>
        </div>

        <div id="start-phase" class="hidden">
            <h3 class="text-navy-900 font-black text-2xl mb-8 flex items-center gap-4">
                <span class="w-10 h-1 bg-maroon"></span>
                จุดเริ่มต้นการเดินทาง
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <button onclick="directNavigate('TO_IT_BUILDING')" class="room-card p-10 text-left group">
                    <i class="fa-solid fa-building-shield text-4xl mb-6 text-[#002D62]"></i>
                    <h4 class="text-2xl font-black mb-3 text-navy-900">จากป้อมยาม (ประตู 1)</h4>
                    <p class="text-gray-500 text-sm mb-6">เส้นทางจากทางเข้าหลักวิทยาลัย มุ่งหน้าสู่อาคารแผนกเทคโนโลยีสารสนเทศ</p>
                    <div class="text-maroon font-bold flex items-center gap-2 group-hover:gap-4 transition-all">
                        เริ่มนำทางทันที <i class="fa-solid fa-arrow-right"></i>
                    </div>
                </button>
                <button onclick="directNavigate('FROM_IT_TO_GATE')" class="room-card p-10 text-left group">
                    <i class="fa-solid fa-door-open text-4xl mb-6 text-[#002D62]"></i>
                    <h4 class="text-2xl font-black mb-3 text-navy-900">ออกจากแผนกไอที</h4>
                    <p class="text-gray-500 text-sm mb-6">เส้นทางจากหน้าแผนก มุ่งหน้ากลับไปยังประตูทางเข้าหลัก (ประตู 1)</p>
                    <div class="text-maroon font-bold flex items-center gap-2 group-hover:gap-4 transition-all">
                        เริ่มนำทางทันที <i class="fa-solid fa-arrow-right"></i>
                    </div>
                </button>
            </div>
        </div>

        <div id="floor-3" class="hidden">
            <div class="flex justify-between items-end mb-10 border-b-2 border-gray-100 pb-4">
                <h3 class="text-[#002D62] font-black text-3xl">ชั้น 3 <span class="text-gray-300 font-light ml-2">/ ห้องเรียนทั่วไป</span></h3>
                <span class="text-maroon font-bold text-sm tracking-widest uppercase">STC-IT Floor 03</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="rooms-3"></div>
        </div>

        <div id="floor-4" class="hidden">
            <div class="flex justify-between items-end mb-10 border-b-2 border-gray-100 pb-4">
                <h3 class="text-[#002D62] font-black text-3xl">ชั้น 4 <span class="text-gray-300 font-light ml-2">/ ห้องปฏิบัติการ</span></h3>
                <span class="text-maroon font-bold text-sm tracking-widest uppercase">STC-IT Floor 04</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="rooms-4"></div>
        </div>
    </main>

    <footer class="main-footer">
        <div class="max-w-6xl mx-auto px-6 flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="text-center md:text-left">
                <p class="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-1">Developed By</p>
                <p class="text-[#002D62] font-bold text-sm">แผนกเทคโนโลยีสารสนเทศ วิทยาลัยเทคนิคสุราษฎร์ธานี</p>
            </div>
            <div class="flex items-center gap-6">
                <a href="https://www.facebook.com/sit.stc" target="_blank" class="text-gray-400 hover:text-blue-600 transition-colors">
                    <i class="fa-brands fa-facebook-f text-lg"></i>
                </a>
                <a href="index.html" class="flex items-center">
                    <img src="it-logo.png" alt="IT Logo" class="h-7 w-auto grayscale hover:grayscale-0 transition-all duration-300 cursor-pointer">
                </a>
            </div>
        </div>
    </footer>

    <div id="room-detail-modal" class="fixed inset-0 z-[150] flex items-center justify-center p-4 hidden">
        <div class="absolute inset-0 bg-[#001A35]/95 backdrop-blur-md" onclick="closeRoomDetail()"></div>
        <div class="relative bg-white w-full max-w-lg shadow-2xl modal-content animate-[fadeIn_0.3s_ease-out]">
            <div class="p-8">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <span class="text-xs font-black text-maroon tracking-widest uppercase" id="modal-room-id">ROOM ID</span>
                        <h3 id="modal-room-name" class="text-3xl font-black text-[#002D62]">ชื่อห้องเรียน</h3>
                    </div>
                    <button onclick="closeRoomDetail()" class="text-gray-300 hover:text-red-600 transition-colors"><i class="fa-solid fa-times text-2xl"></i></button>
                </div>
                
                <div class="border-2 border-gray-100 p-2 mb-6">
                    <img id="modal-room-image" src="" class="w-full h-56 object-cover bg-gray-50" onerror="this.src='https://placehold.co/600x400/002D62/FFF?text=IT+STC+ROOM'">
                </div>

                <div class="bg-gray-50 p-6 border-l-4 border-maroon mb-8">
                    <p class="text-[10px] font-bold text-gray-400 uppercase mb-2">Navigation Instructions</p>
                    <p id="modal-room-guide" class="text-navy-900 font-medium leading-relaxed">ข้อมูลการนำทางจะปรากฏที่นี่...</p>
                </div>

                <button id="btn-start-nav" class="w-full btn-stc-action py-5 text-lg uppercase tracking-widest">
                    <i class="fa-solid fa-compass animate-pulse"></i> เริ่มต้นการนำทาง AR
                </button>
            </div>
        </div>
    </div>

    <script>
        // ข้อมูลชุดเดิม
        const navigationData = {
            "TO_IT_BUILDING": { angle: 0, dist: 195, guide: "จากป้อมยามเดินตรงเข้ามาชั้นล่างตึกไอที (ตึกม่วง)" },
            "FROM_IT_TO_GATE": { angle: 180, dist: 195, guide: "จากหน้าตึกไอทีเดินย้อนกลับไปที่ป้อมยามหน้าประตู 1" },
            "DEPT_LABEL_3": { angle: 0, dist: 2, guide: "คุณอยู่บริเวณโถงหน้าป้ายแผนกชั้น 3" },
            "631": { angle: 90, dist: 15, guide: "จากโถงชั้น 3 เดินไปทางขวาสุด" },
            "632": { angle: 90, dist: 10, guide: "จากโถงชั้น 3 เดินไปทางขวา" },
            "633": { angle: 270, dist: 12, guide: "จากโถงชั้น 3 เดินไปทางซ้าย" },
            "634": { angle: 90, dist: 22, guide: "จากโถงชั้น 3 เดินไปทางขวาสุด (โซนศูนย์บ่มเพาะ)" },
            "635": { angle: 270, dist: 5, guide: "จากโถงชั้น 3 เลี้ยวซ้ายทันที (ติดบันได)" },
            "DEPT_LABEL_4": { angle: 0, dist: 2, guide: "คุณอยู่บริเวณหน้าโถงทางเข้าชั้น 4" },
            "TEACHER_ROOM": { angle: 90, dist: 5, guide: "จากโถงบันไดชั้น 4 เลี้ยวขวาเข้าห้องพักครู" },
            "LECTURE": { angle: 270, dist: 8, guide: "จากโถงบันไดชั้น 4 เลี้ยวซ้ายไปห้องบรรยาย" },
            "LAB1": { angle: 0, dist: 15, guide: "จากโถงชั้น 4 เดินตรงไปห้องแล็บ 1" },
            "LAB2": { angle: 0, dist: 18, guide: "จากโถงชั้น 4 เดินตรงไปห้องแล็บ 2" },
            "LAB3": { angle: 0, dist: 20, guide: "จากโถงชั้น 4 เดินตรงไปห้องแล็บ 3" }
        };

        const roomNames = {
            "TEACHER_ROOM": "ห้องพักครูแผนกไอที", "LECTURE": "ห้องบรรยาย (Lecture)", "LAB1": "ห้องปฏิบัติการคอมพิวเตอร์ 1", "LAB2": "ห้องปฏิบัติการคอมพิวเตอร์ 2", "LAB3": "ห้องปฏิบัติการคอมพิวเตอร์ 3",
            "631": "ห้องเรียน 631", "632": "ห้องเรียน 632", "633": "ห้องเรียน 633", "634": "ห้องเรียน 634", "635": "ห้องเรียน 635"
        };

        const roomImages = {
            'TEACHER_ROOM': 'breakteacher.jpeg', 'LECTURE': 'lecture.jpeg', 'LAB1': 'lab 1.jpeg',
            'LAB2': 'lab 2.jpeg', 'LAB3': 'lab 3.jpeg', '631': '631.jpeg', '632': '632.jpeg',
            '633': '633.jpeg', '634': '634.jpeg', '635': '635.jpeg'
        };

        function runLoading() {
            const loadingScreen = document.getElementById('loading-screen');
            const progressFill = document.getElementById('progress-fill');
            const isFirstVisit = !sessionStorage.getItem('stc_init');
            if (!isFirstVisit) { loadingScreen.style.display = 'none'; return; }
            
            let progress = 0;
            const timer = setInterval(() => {
                progress += Math.random() * 15;
                if (progress >= 100) {
                    progress = 100; clearInterval(timer);
                    setTimeout(() => {
                        loadingScreen.style.opacity = '0';
                        setTimeout(() => {
                            loadingScreen.style.display = 'none';
                            sessionStorage.setItem('stc_init', 'true');
                        }, 500);
                    }, 500);
                }
                progressFill.style.width = progress + '%';
            }, 100);
        }

        function renderRooms(floor) {
            const container = document.getElementById(`rooms-${floor}`);
            if (!container) return;
            container.innerHTML = '';
            
            Object.keys(navigationData).forEach(key => {
                if (key.includes("TO_") || key.includes("FROM_") || key.startsWith("DEPT_")) return;
                const isFloor3 = ['631','632','633','634','635'].includes(key);
                if ((floor === 3 && isFloor3) || (floor === 4 && !isFloor3)) {
                    container.innerHTML += `
                        <button onclick="openRoomDetail('${key}')" class="room-card p-8 text-left group">
                            <div class="text-[10px] font-bold text-maroon mb-2 uppercase tracking-widest border-b pb-1">Code: ${key}</div>
                            <h4 class="text-xl font-extrabold text-[#002D62] mb-4">${roomNames[key] || key}</h4>
                            <div class="flex items-center justify-between mt-6">
                                <span class="text-xs font-bold text-gray-400">View Details</span>
                                <div class="w-8 h-8 bg-gray-50 flex items-center justify-center group-hover:bg-maroon group-hover:text-white transition-all">
                                    <i class="fa-solid fa-chevron-right text-[10px]"></i>
                                </div>
                            </div>
                        </button>`;
                }
            });
        }

        function openRoomDetail(roomId) {
            const data = navigationData[roomId];
            document.getElementById('modal-room-id').innerText = "Location ID: " + roomId;
            document.getElementById('modal-room-name').innerText = roomNames[roomId] || roomId;
            document.getElementById('modal-room-guide').innerText = data.guide + ` (ระยะทางโดยประมาณ ${data.dist} เมตร)`;
            document.getElementById('modal-room-image').src = roomImages[roomId] || '';
            document.getElementById('btn-start-nav').onclick = () => directNavigate(roomId);
            document.getElementById('room-detail-modal').classList.remove('hidden');
        }

        function closeRoomDetail() { document.getElementById('room-detail-modal').classList.add('hidden'); }

        function initApp() {
            const params = new URLSearchParams(window.location.search);
            const floor = params.get('floor');
            if (floor === '3' || floor === '4') {
                document.getElementById(`floor-${floor}`).classList.remove('hidden');
                document.getElementById('search-container').classList.remove('hidden');
                document.getElementById(`nav-f${floor}`).classList.add('nav-link-active');
                document.getElementById('floor-title').innerText = "0" + floor;
                renderRooms(parseInt(floor));
            } else {
                document.getElementById('start-phase').classList.remove('hidden');
                document.getElementById('nav-home').classList.add('nav-link-active');
            }
        }

        function directNavigate(roomId) {
            const data = navigationData[roomId];
            window.location.href = `ar-view.html?target=${roomId}&angle=${data.angle}&dist=${data.dist}&guide=${encodeURIComponent(data.guide)}`;
        }

        function searchRoom() {
            const input = document.getElementById('searchInput').value.toLowerCase();
            document.querySelectorAll('.room-card').forEach(card => {
                card.style.display = card.textContent.toLowerCase().includes(input) ? 'block' : 'none';
            });
        }

        window.onload = () => { runLoading(); initApp(); };
    </script>
</body>
</html>
