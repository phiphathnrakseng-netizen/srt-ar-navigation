<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ระบบนำทาง AR | วิทยาลัยเทคนิคสุราษฎร์ธานี</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700;800&family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --stc-beige: #F8F5F0; --stc-beige-light: #FDFCF9; --stc-beige-dark: #EFEAE2; --stc-brown: #8B7355; --stc-brown-light: #A69076; --stc-brown-dark: #6B5A44; --stc-accent: #9C7E5B; --stc-text: #4A4238; --radius-lg: 28px; --radius-md: 18px; }
        * { box-sizing: border-box; font-family: 'Plus Jakarta Sans', 'Noto Sans Thai', sans-serif; }
        body { background: var(--stc-beige-light); color: var(--stc-text); height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
        .glass-nav { background: rgba(253, 252, 249, 0.95); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(139, 115, 85, 0.08); }
        .card-modern { background: #fff; border-radius: var(--radius-lg); border: 1px solid rgba(139, 115, 85, 0.08); transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1); }
        .card-modern:hover { transform: translateY(-5px); shadow: 0 15px 35px rgba(139, 115, 85, 0.08); }
        .btn-primary { background: var(--stc-brown); color: white; border-radius: var(--radius-md); font-weight: 600; transition: all 0.3s; }
        .room-image-container { height: 180px; border-radius: var(--radius-md); overflow: hidden; background: var(--stc-beige-dark); display: flex; align-items: center; justify-content: center; }
        .room-icon { width: 48px; height: 48px; border-radius: var(--radius-md); background: var(--stc-beige); color: var(--stc-brown); display: flex; align-items: center; justify-content: center; }
        #loading-screen { position: fixed; inset: 0; background: var(--stc-beige-light); z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.8s; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--stc-brown-light), var(--stc-accent)); transition: width 0.4s; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .nav-tab.active { background: white; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); color: var(--stc-text) !important; }
    </style>
</head>
<body>
    <div id="loading-screen">
        <div class="w-32 h-32 mb-8 animate-bounce"><img src="https://scontent-bkk1-1.xx.fbcdn.net/v/t39.30808-6/223303958_665537047696775_5725965526684764441_n.jpg?..." class="rounded-full shadow-xl"></div>
        <div class="w-48 h-1 bg-gray-200 rounded-full overflow-hidden"><div id="progress-fill" class="progress-fill w-0"></div></div>
    </div>

    <nav class="glass-nav p-4 sticky top-0 z-50">
        <div class="max-w-6xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-3 cursor-pointer" onclick="location.href='index.html'">
                <img src="https://scontent-bkk1-1.xx.fbcdn.net/v/t39.30808-6/223303958_665537047696775_5725965526684764441_n.jpg?..." class="w-10 h-10 rounded-xl">
                <div class="hidden sm:block text-sm font-bold">SRTC Navigator<p class="text-[10px] font-normal opacity-70">Surat Thani Technical College</p></div>
            </div>
            <div class="flex bg-[#EFEAE2] p-1 rounded-xl gap-1">
                <a href="index.html" id="nav-home" class="nav-tab px-4 py-2 rounded-lg text-xs font-medium text-[#A69076]">หน้าหลัก</a>
                <a href="?floor=3" id="nav-f3" class="nav-tab px-4 py-2 rounded-lg text-xs font-medium text-[#A69076]">ชั้น 3</a>
                <a href="?floor=4" id="nav-f4" class="nav-tab px-4 py-2 rounded-lg text-xs font-medium text-[#A69076]">ชั้น 4</a>
            </div>
        </div>
    </nav>

    <div class="flex-1 overflow-y-auto hide-scrollbar p-4">
        <div id="home-content" class="max-w-4xl mx-auto py-8">
            <div class="text-center mb-12">
                <span class="bg-[#8B735514] text-[#8B7355] px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider">Augmented Reality Navigation</span>
                <h2 class="text-3xl font-bold mt-4">ระบบนำทางแผนก<br><span class="text-[#8B7355]">เทคโนโลยีสารสนเทศ</span></h2>
                <p class="text-[#A69076] mt-4 text-sm">ค้นหาห้องเรียนและห้องปฏิบัติการด้วยเทคโนโลยี AR</p>
            </div>

            <div id="search-container" class="mb-8 hidden relative">
                <input type="text" id="searchInput" onkeyup="searchRoom()" placeholder="ค้นหาห้องเรียน..." class="w-full p-4 pl-12 rounded-2xl border border-gray-100 shadow-sm outline-none focus:border-[#8B7355]">
                <i class="fa-solid fa-magnifying-glass absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
            </div>

            <div id="start-phase" class="hidden grid gap-6">
                <div class="card-modern p-6 flex flex-col md:flex-row justify-between items-center gap-4">
                    <div><h3 class="text-lg font-bold">เริ่มต้นการนำทาง</h3><p class="text-xs text-gray-500">จากป้อมยามประตู 1 ไปยังอาคารไอที</p></div>
                    <button onclick="navigate('TO_IT_BUILDING')" class="btn-primary px-6 py-3 text-sm flex items-center gap-2"><i class="fa-solid fa-location-arrow"></i> เริ่มนำทาง</button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <a href="?floor=3" class="card-modern p-4 flex items-center gap-4 hover:bg-[#F8F5F0]">
                        <div class="room-icon"><i class="fa-solid fa-chalkboard-user"></i></div>
                        <div><h5 class="font-bold">ชั้น 3</h5><p class="text-[10px] text-gray-500">ห้องบรรยายทั่วไป</p></div>
                    </a>
                    <a href="?floor=4" class="card-modern p-4 flex items-center gap-4 hover:bg-[#F8F5F0]">
                        <div class="room-icon"><i class="fa-solid fa-computer"></i></div>
                        <div><h5 class="font-bold">ชั้น 4</h5><p class="text-[10px] text-gray-500">ห้องปฏิบัติการคอมพิวเตอร์</p></div>
                    </a>
                </div>
            </div>

            <div id="floor-3" class="hidden grid grid-cols-1 md:grid-cols-3 gap-4"></div>
            <div id="floor-4" class="hidden grid grid-cols-1 md:grid-cols-3 gap-4"></div>
            <div id="empty-state" class="hidden text-center py-10"><p>ไม่พบข้อมูลที่ค้นหา</p></div>
        </div>
    </div>

    <footer class="p-6 bg-white border-t text-center">
        <p class="text-[10px] text-gray-400">© 2024-2025 วิทยาลัยเทคนิคสุราษฎร์ธานี | แผนกเทคโนโลยีสารสนเทศ</p>
    </footer>

    <script>
        const navigationData = {
            "TO_IT_BUILDING": { angle: 0, dist: 195, guide: "เดินตรงจากป้อมยามผ่านอาคารอำนวยการตึก 11" },
            "631": { angle: 5, dist: 215, guide: "ชั้น 3 ห้องอยู่ฝั่งขวา" }, "632": { angle: 5, dist: 220, guide: "ชั้น 3 ห้องอยู่ฝั่งขวา" },
            "633": { angle: 5, dist: 225, guide: "ชั้น 3 ห้องอยู่ฝั่งซ้าย" }, "634": { angle: 5, dist: 230, guide: "ชั้น 3 ห้องอยู่สุดทางขวา" },
            "635": { angle: 5, dist: 210, guide: "ชั้น 3 ห้องแรกซ้ายมือ" }, "TEACHER_ROOM": { angle: 5, dist: 220, guide: "ชั้น 4 ห้องพักครูอยู่ขวามือ" },
            "LAB1": { angle: 5, dist: 230, guide: "ชั้น 4 ห้องปฏิบัติการ 1" }, "LAB2": { angle: 5, dist: 235, guide: "ชั้น 4 ห้องปฏิบัติการ 2" },
            "LAB3": { angle: 5, dist: 240, guide: "ชั้น 4 ห้องปฏิบัติการ 3" }
        };

        const roomDetails = {
            "631": { name: "ห้องเรียน 631", desc: "ห้องเรียนสำหรับนักศึกษาชั้นปีที่ 1" },
            "632": { name: "ห้องเรียน 632", desc: "ห้องเรียนสำหรับนักศึกษาชั้นปีที่ 2" },
            "633": { name: "ห้องเรียน 633", desc: "ห้องเรียนสำหรับนักศึกษาชั้นปีที่ 3" },
            "634": { name: "ห้องเรียน 634", desc: "ห้องเรียนสำหรับนักศึกษาชั้นปีที่ 4" },
            "635": { name: "ห้องเรียน 635", desc: "ห้องเรียนสำหรับนักศึกษาชั้นปีที่ 5" },
            "TEACHER_ROOM": { name: "ห้องพักครู IT", desc: "ห้องพักครูประจำแผนก" },
            "LAB1": { name: "Computer Lab 1", desc: "ห้องปฏิบัติการคอมพิวเตอร์พื้นฐาน" },
            "LAB2": { name: "Computer Lab 2", desc: "ห้องปฏิบัติการเครือข่าย" },
            "LAB3": { name: "Computer Lab 3", desc: "ห้องปฏิบัติการโปรแกรมมิ่ง" }
        };

        function initApp() {
            const floor = new URLSearchParams(window.location.search).get('floor');
            if (floor === '3' || floor === '4') {
                document.getElementById('floor-' + floor).classList.remove('hidden');
                document.getElementById('search-container').classList.remove('hidden');
                document.getElementById('nav-f' + floor).classList.add('active');
                renderRooms(floor);
            } else {
                document.getElementById('start-phase').classList.remove('hidden');
                document.getElementById('nav-home').classList.add('active');
            }
        }

        function renderRooms(floor) {
            const container = document.getElementById(`rooms-${floor}`);
            container.innerHTML = '';
            Object.keys(roomDetails).forEach(id => {
                const isF3 = id.startsWith('63');
                if ((floor == 3 && isF3) || (floor == 4 && !isF3)) {
                    container.innerHTML += `
                        <div class="card-modern p-4">
                            <div class="room-image-container mb-4"><i class="fa-solid fa-image text-gray-300"></i></div>
                            <div class="flex justify-between items-center mb-2"><span class="bg-gray-100 px-2 py-1 rounded text-[10px]">${id}</span></div>
                            <h4 class="font-bold text-sm">${roomDetails[id].name}</h4>
                            <p class="text-[10px] text-gray-500 mb-4">${roomDetails[id].desc}</p>
                            <button onclick="navigate('${id}')" class="w-full btn-primary py-2 text-xs">เปิดนำทาง AR</button>
                        </div>`;
                }
            });
        }

        function navigate(id) {
            const d = navigationData[id];
            window.location.href = `ar-view.html?target=${id}&angle=${d.angle}&dist=${d.dist}&guide=${encodeURIComponent(d.guide)}`;
        }

        function searchRoom() {
            const q = document.getElementById('searchInput').value.toLowerCase();
            document.querySelectorAll('.card-modern').forEach(c => {
                c.style.display = c.innerText.toLowerCase().includes(q) ? 'block' : 'none';
            });
        }

        window.onload = () => {
            let p = 0;
            const iv = setInterval(() => {
                p += 20;
                document.getElementById('progress-fill').style.width = p + '%';
                if (p >= 100) {
                    clearInterval(iv);
                    setTimeout(() => { document.getElementById('loading-screen').classList.add('opacity-0', 'invisible'); initApp(); }, 500);
                }
            }, 100);
        };
    </script>
</body>
</html>
